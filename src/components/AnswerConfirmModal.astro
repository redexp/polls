---
import Modal from './Modal.astro';
import LoginButton from './LoginButton.astro';
---

<Modal
	id="answer-confirm"
	title="Ідентифікація"
>
	<p>
        Натискаючи кнопку «Погоджуюсь», Ви даєте згоду на обробку та зберігання даних про Вашу <strong>стать</strong>, <strong>вік</strong> і <strong>район Вашої реєстрації</strong>.
	</p>

    <p>
        Ця інформація не буде публічною.
	</p>

	<a href="/faq/#pro-vashi-dani" target="_blank">
        Детальніше про те, як ми збираємо, захищаємо та аналізуємо Ваші дані
    </a>

	<Fragment slot="footer">
		<LoginButton
			id="confirm-auth-btn"
			loginTitle="Погодитись та увійти з"
			logout={false}
			size="lg"
		/>

        <button
			id="confirm-btn"
			type="button"
			class="btn btn-primary"
			style="min-width: 122px"
        >
            <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
            <span class="text">Погоджуюсь</span>
		</button>

        <button
			type="button"
			class="btn btn-light"
			data-close
		>Відмовитись</button>
	</Fragment>
</Modal>

<style lang="less">
	label.btn {
		input {
			opacity: 0;
			width: 1px;
			height: 1px;
		}

		+ div {
			display: none;
		}

		&:has(input:checked) + div {
			display: block;
		}
	}
</style>

<script>
	import {onChange} from '../lib/auth';
	import {byId, qs} from '../lib/dom';

	onChange(authed => {
		qs('#answer-confirm .modal-header').classList.toggle('d-none', authed);
		byId('confirm-auth-btn').classList.toggle('d-none', authed);
		byId('confirm-btn').classList.toggle('d-none', !authed);
	});
</script>